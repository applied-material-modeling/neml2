<!-- HTML header for doxygen 1.13.2-->
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=11" />
  <meta name="generator" content="Doxygen 1.13.2" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>NEML2: Model parameters (revisited)</title>
  <link href="tabs.css" rel="stylesheet" type="text/css" />
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <script type="text/javascript" src="clipboard.js"></script>
  <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/javascript">
window.MathJax = {
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  }
};
window.MathJax = {
  loader: {load: ['[tex]/ams', '[tex]/physics', '[tex]/boldsymbol']},
  tex: {packages: {'[+]': ['ams', 'physics', 'boldsymbol']},
        tags: 'ams'}
};
</script>
<script type="text/javascript" id="MathJax-script" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-tabs.js" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
  <script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
  <script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
  <!-- Demo animations -->
  <script type="text/javascript" src="anime.min.js"></script>
  <script type="text/javascript" src="work-dispatcher.js"></script>
  <script type="text/javascript" src="static-hybrid-scheduler.js"></script>
  <script type="text/javascript" src="simple-scheduler-demo.js"></script>
  <script type="text/javascript" src="static-hybrid-scheduler-demo.js"></script>
  <script type="text/javascript">
    DoxygenAwesomeDarkModeToggle.init();
    DoxygenAwesomeParagraphLink.init();
    DoxygenAwesomeTabs.init();
    SimpleSchedulerDemo.init();
    StaticHybridSchedulerDemo.init();
  </script>
</head>
<body>
    <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
      <div id="titlearea">
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr id="projectrow">
              <td id="projectalign">
                <div id="projectname">NEML2<span
                    id="projectnumber">&#160;2.0.0</span>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('tutorials-models-model-parameters-revisited.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Model parameters (revisited)</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul>
  <li class="level1">
    <a href="#autotoc_md109">Problem description</a>
  </li>
  <li class="level1">
    <a href="#autotoc_md110">Parameter specification</a>
    <ul>
      <li class="level2">
        <a href="#autotoc_md111">Plain numeric literal</a>
      </li>
      <li class="level2">
        <a href="#autotoc_md112">Tensor name</a>
      </li>
      <li class="level2">
        <a href="#autotoc_md113">Variable specifier</a>
      </li>
    </ul>
  </li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_content_2tutorials_2models_2model__parameters__revisited_2main"></a></p>
<h1><a class="anchor" id="autotoc_md109"></a>
Problem description</h1>
<p>In a <a class="el" href="tutorials-models-model-parameters.html">previous tutorial</a>, we briefly explained the usage of model parameters and their retrieval and update. In this tutorial, we will introduce other ways of specifying model parameters in the input file and how they facilitate model composition.</p>
<p>Consider the following equations describing the stress-strain relation accounting for a thermal eigenstrain:     </p><p class="formulaDsp">
\begin{align}  \boldsymbol{\varepsilon}^g &amp; = \alpha (T - T_0) \boldsymbol{I}, \label{1} \\
  \boldsymbol{\varepsilon}^e &amp; = \boldsymbol{\varepsilon} - \boldsymbol{\varepsilon}^g, \label{2} \\
  \boldsymbol{\sigma} &amp; = 3 K \operatorname{vol} \boldsymbol{\varepsilon}^e + 2 G \operatorname{dev} \boldsymbol{\varepsilon}^e, \label{3}
\end{align}
</p>
<p> where \( \alpha \) is the coefficient of thermal expansion, and \( T_0 \) is the reference temperature at which the thermal eigenstrain is zero.</p>
<h1><a class="anchor" id="autotoc_md110"></a>
Parameter specification</h1>
<p>In NEML2 input files, model parameters can be specified in one of three ways:</p><ol type="1">
<li>As plain numeric literals</li>
<li>Using the name of a tensor</li>
<li>Using a <em>variable specifier</em></li>
</ol>
<h2><a class="anchor" id="autotoc_md111"></a>
Plain numeric literal</h2>
<p>In this mode, parameter values are directly specified by plain numbers. The corresponding input file looks like </p><div class="fragment"><div class="line">[Models]</div>
<div class="line">  [eq1]</div>
<div class="line">    type = ThermalEigenstrain</div>
<div class="line">    reference_temperature = &#39;300&#39;</div>
<div class="line">    CTE = &#39;1e-6&#39;</div>
<div class="line">    eigenstrain = &#39;forces/Eg&#39;</div>
<div class="line">  []</div>
<div class="line">  [eq2]</div>
<div class="line">    type = SR2LinearCombination</div>
<div class="line">    from_var = &#39;forces/E forces/Eg&#39;</div>
<div class="line">    to_var = &#39;forces/Ee&#39;</div>
<div class="line">    coefficients = &#39;1 -1&#39;</div>
<div class="line">  []</div>
<div class="line">  [eq3]</div>
<div class="line">    type = LinearIsotropicElasticity</div>
<div class="line">    strain = &#39;forces/Ee&#39;</div>
<div class="line">    stress = &#39;state/S&#39;</div>
<div class="line">    coefficient_types = &#39;BULK_MODULUS SHEAR_MODULUS&#39;</div>
<div class="line">    coefficients = &#39;1.4e5 7.8e4&#39;</div>
<div class="line">  []</div>
<div class="line">  [eq]</div>
<div class="line">    type = ComposedModel</div>
<div class="line">    models = &#39;eq1 eq2 eq3&#39;</div>
<div class="line">  []</div>
<div class="line">[]</div>
</div><!-- fragment --><p>As usual, we can inspect the structure of the composed model using the following code.</p>
<div class="tabbed"></div><div class="tabbed"><ul>
<li><p class="startli"><b class="tab-title">C++</b> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;neml2/models/Model.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">main()</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">using namespace </span><a class="code hl_namespace" href="namespaceneml2.html">neml2</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> &amp; model = <a class="code hl_function" href="namespaceneml2.html#a1e499dee97d6a66663f60dd4a65b9f1a">load_model</a>(<span class="stringliteral">&quot;input1.i&quot;</span>, <span class="stringliteral">&quot;eq&quot;</span>);</div>
<div class="line">  std::cout &lt;&lt; model &lt;&lt; std::endl;</div>
<div class="line">}</div>
<div class="ttc" id="anamespaceneml2_html"><div class="ttname"><a href="namespaceneml2.html">neml2</a></div><div class="ttdef"><b>Definition</b> DiagnosticsInterface.cxx:30</div></div>
<div class="ttc" id="anamespaceneml2_html_a1e499dee97d6a66663f60dd4a65b9f1a"><div class="ttname"><a href="namespaceneml2.html#a1e499dee97d6a66663f60dd4a65b9f1a">neml2::load_model</a></div><div class="ttdeci">Model &amp; load_model(const std::filesystem::path &amp;path, const std::string &amp;mname)</div><div class="ttdoc">A convenient function to load an input file and get a model.</div><div class="ttdef"><b>Definition</b> Model.cxx:47</div></div>
</div><!-- fragment --><p class="startli">Output: </p><div class="fragment"><div class="line">Name:       eq</div>
<div class="line">Input:      forces/E [SR2]</div>
<div class="line">            forces/T [Scalar]</div>
<div class="line">Output:     state/S [SR2]</div>
<div class="line">Parameters: eq1_alpha [Scalar][Float][cpu]</div>
<div class="line">            eq3_G [Scalar][Float][cpu]</div>
<div class="line">            eq3_K [Scalar][Float][cpu]</div>
<div class="line">Buffers:    eq1_T0 [Scalar][Float][cpu]</div>
<div class="line">            eq2_c_0 [Scalar][Float][cpu]</div>
<div class="line">            eq2_c_1 [Scalar][Float][cpu]</div>
</div><!-- fragment --></li>
<li><p class="startli"><b class="tab-title">Python</b> </p><div class="fragment"><div class="line"><span class="keyword">import</span> neml2</div>
<div class="line"> </div>
<div class="line">model = <a class="code hl_function" href="namespaceneml2.html#a1e499dee97d6a66663f60dd4a65b9f1a">neml2.load_model</a>(<span class="stringliteral">&quot;input1.i&quot;</span>, <span class="stringliteral">&quot;eq&quot;</span>)</div>
<div class="line">print(model)</div>
</div><!-- fragment --><p class="startli">Output: </p><div class="fragment"><div class="line">Name:       eq</div>
<div class="line">Input:      forces/E [SR2]</div>
<div class="line">            forces/T [Scalar]</div>
<div class="line">Output:     state/S [SR2]</div>
<div class="line">Parameters: eq1_alpha [Scalar][Float][cpu]</div>
<div class="line">            eq3_G [Scalar][Float][cpu]</div>
<div class="line">            eq3_K [Scalar][Float][cpu]</div>
<div class="line">Buffers:    eq1_T0 [Scalar][Float][cpu]</div>
<div class="line">            eq2_c_0 [Scalar][Float][cpu]</div>
<div class="line">            eq2_c_1 [Scalar][Float][cpu]</div>
</div><!-- fragment --></li>
</ul>
</div><div class="tabbed"></div><p>The composed model has two input variables (strain and temperature), one output variable (stress), and three parameters:</p><ul>
<li><code>eq1_alpha</code>: Coefficient of thermal expansion defined in <code>eq1</code>.</li>
<li><code>eq3_G</code>: Shear modulus defined in <code>eq3</code>.</li>
<li><code>eq3_K</code>: Bulk modulus defined in <code>eq3</code>.</li>
</ul>
<p>Note that the parameters of the composed model is defined by the <em>union</em> of the sub-model parameters, and that their names are prefixed by the name of the sub-model.</p>
<h2><a class="anchor" id="autotoc_md112"></a>
Tensor name</h2>
<p>While specifying parameter values as plain numeric literals is convenient and expressive, it is however not always possible to do so. For example, when the parameter value is <em>batched</em>, it is not possible to fully define it using one number. In such scenario, a tensor can be created under the <code>[Tensors]</code> section, and the name of that tensor can be used in place of the parameter value.</p>
<p>The following example input file shows how to specify the coefficient of thermal expansion as a batched scalar: </p><div class="fragment"><div class="line">[Tensors]</div>
<div class="line">  [alpha]</div>
<div class="line">    type = Scalar</div>
<div class="line">    values = &#39;1e-6 2e-6 1e-5 5e-7&#39;</div>
<div class="line">    batch_shape = (2,2)</div>
<div class="line">  []</div>
<div class="line">[]</div>
<div class="line"> </div>
<div class="line">[Models]</div>
<div class="line">  [eq1]</div>
<div class="line">    type = ThermalEigenstrain</div>
<div class="line">    reference_temperature = &#39;300&#39;</div>
<div class="line">    CTE = &#39;alpha&#39;</div>
<div class="line">    eigenstrain = &#39;forces/Eg&#39;</div>
<div class="line">  []</div>
<div class="line">  [eq2]</div>
<div class="line">    type = SR2LinearCombination</div>
<div class="line">    from_var = &#39;forces/E forces/Eg&#39;</div>
<div class="line">    to_var = &#39;forces/Ee&#39;</div>
<div class="line">    coefficients = &#39;1 -1&#39;</div>
<div class="line">  []</div>
<div class="line">  [eq3]</div>
<div class="line">    type = LinearIsotropicElasticity</div>
<div class="line">    strain = &#39;forces/Ee&#39;</div>
<div class="line">    stress = &#39;state/S&#39;</div>
<div class="line">    coefficient_types = &#39;BULK_MODULUS SHEAR_MODULUS&#39;</div>
<div class="line">    coefficients = &#39;1.4e5 7.8e4&#39;</div>
<div class="line">  []</div>
<div class="line">  [eq]</div>
<div class="line">    type = ComposedModel</div>
<div class="line">    models = &#39;eq1 eq2 eq3&#39;</div>
<div class="line">  []</div>
<div class="line">[]</div>
</div><!-- fragment --><p>In this input file, a tensor named "alpha" with batch shape <code>(2, 2)</code> is created under the "[Tensors]" section. The coefficient of thermal expansion in model "eq1" then references that tensor using its name, i.e., "CTE = 'alpha'". Note that this approach does not alter the model structure, i.e., <code>eq1_alpha</code> is still a model parameter, albeit initialized with the tensor value.</p>
<div class="tabbed"></div><div class="tabbed"><ul>
<li><p class="startli"><b class="tab-title">C++</b> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;neml2/models/Model.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;neml2/tensors/Tensor.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">main()</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">using namespace </span><a class="code hl_namespace" href="namespaceneml2.html">neml2</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> &amp; model = <a class="code hl_function" href="namespaceneml2.html#a1e499dee97d6a66663f60dd4a65b9f1a">load_model</a>(<span class="stringliteral">&quot;input2.i&quot;</span>, <span class="stringliteral">&quot;eq&quot;</span>);</div>
<div class="line">  std::cout &lt;&lt; model &lt;&lt; std::endl &lt;&lt; std::endl;</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;eq1_alpha:\n&quot;</span> &lt;&lt; <a class="code hl_class" href="classneml2_1_1Tensor.html">Tensor</a>(model.get_parameter(<span class="stringliteral">&quot;eq1_alpha&quot;</span>)) &lt;&lt; std::endl;</div>
<div class="line">}</div>
<div class="ttc" id="aclassneml2_1_1Tensor_html"><div class="ttname"><a href="classneml2_1_1Tensor.html">neml2::Tensor</a></div><div class="ttdef"><b>Definition</b> Tensor.h:46</div></div>
</div><!-- fragment --><p class="startli">Output: </p><div class="fragment"><div class="line">Name:       eq</div>
<div class="line">Input:      forces/E [SR2]</div>
<div class="line">            forces/T [Scalar]</div>
<div class="line">Output:     state/S [SR2]</div>
<div class="line">Parameters: eq1_alpha [Scalar][Float][cpu]</div>
<div class="line">            eq3_G [Scalar][Float][cpu]</div>
<div class="line">            eq3_K [Scalar][Float][cpu]</div>
<div class="line">Buffers:    eq1_T0 [Scalar][Float][cpu]</div>
<div class="line">            eq2_c_0 [Scalar][Float][cpu]</div>
<div class="line">            eq2_c_1 [Scalar][Float][cpu]</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">eq1_alpha:</div>
<div class="line">1e-06 *</div>
<div class="line"> 1.0000  2.0000</div>
<div class="line"> 10.0000  0.5000</div>
<div class="line">[ CPUFloatType{2,2} ]</div>
</div><!-- fragment --></li>
<li><p class="startli"><b class="tab-title">Python</b> </p><div class="fragment"><div class="line"><span class="keyword">import</span> neml2</div>
<div class="line"> </div>
<div class="line">model = <a class="code hl_function" href="namespaceneml2.html#a1e499dee97d6a66663f60dd4a65b9f1a">neml2.load_model</a>(<span class="stringliteral">&quot;input2.i&quot;</span>, <span class="stringliteral">&quot;eq&quot;</span>)</div>
<div class="line">print(model, <span class="stringliteral">&quot;\n&quot;</span>)</div>
<div class="line">print(<span class="stringliteral">&quot;eq1_alpha:&quot;</span>)</div>
<div class="line">print(model.eq1_alpha.tensor())</div>
</div><!-- fragment --><p class="startli">Output: </p><div class="fragment"><div class="line">Name:       eq</div>
<div class="line">Input:      forces/E [SR2]</div>
<div class="line">            forces/T [Scalar]</div>
<div class="line">Output:     state/S [SR2]</div>
<div class="line">Parameters: eq1_alpha [Scalar][Float][cpu]</div>
<div class="line">            eq3_G [Scalar][Float][cpu]</div>
<div class="line">            eq3_K [Scalar][Float][cpu]</div>
<div class="line">Buffers:    eq1_T0 [Scalar][Float][cpu]</div>
<div class="line">            eq2_c_0 [Scalar][Float][cpu]</div>
<div class="line">            eq2_c_1 [Scalar][Float][cpu]</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">eq1_alpha:</div>
<div class="line">1e-06 *</div>
<div class="line"> 1.0000  2.0000</div>
<div class="line"> 10.0000  0.5000</div>
<div class="line">[ CPUFloatType{2,2} ]</div>
<div class="line">&lt;Tensor of shape [2, 2][]&gt;</div>
</div><!-- fragment --></li>
</ul>
</div><div class="tabbed"></div><h2><a class="anchor" id="autotoc_md113"></a>
Variable specifier</h2>
<p>While specifying parameters using tensor names is significantly more flexible than using plain numeric literals, the parameter values still remain "static", i.e., the parameter values remain the same during model evaluation unless explicitly updated by the user. In practice, especially when dealing with multiple physics phenomena such as thermal-mechanical coupling, this limitation makes it difficult to specify temperature-dependent parameters.</p>
<p>To remove this limitation, NEML2 allows the use of <em>variable specifiers</em> to define model parameters. Suppose the original problem is modified to account for temperature-dependent parameters, e.g.,     </p><p class="formulaDsp">
\begin{align*}  \boldsymbol{\varepsilon}^g &amp; = \textcolor{blue}{\alpha(T)} (T - T_0) \boldsymbol{I}, \\
  \boldsymbol{\varepsilon}^e &amp; = \boldsymbol{\varepsilon} - \boldsymbol{\varepsilon}^g, \\
  \boldsymbol{\sigma} &amp; = 3 \textcolor{blue}{K(T)} \operatorname{vol} \boldsymbol{\varepsilon}^e + 2 \textcolor{blue}{G(T)} \operatorname{dev} \boldsymbol{\varepsilon}^e,
\end{align*}
</p>
<p> where \( \alpha(T) \), \( K(T) \), and \( G(T) \) are linearly interpolated from given data. The input file can be modified accordingly: </p><div class="fragment"><div class="line">[Models]</div>
<div class="line">  [alpha]</div>
<div class="line">    type = ScalarLinearInterpolation</div>
<div class="line">    argument = &#39;forces/T&#39;</div>
<div class="line">    abscissa = &#39;300 400 500&#39;</div>
<div class="line">    ordinate = &#39;1e-5 1.5e-5 1.8e-5&#39;</div>
<div class="line">  []</div>
<div class="line">  [K]</div>
<div class="line">    type = ScalarLinearInterpolation</div>
<div class="line">    argument = &#39;forces/T&#39;</div>
<div class="line">    abscissa = &#39;300 350 400 450&#39;</div>
<div class="line">    ordinate = &#39;1.4e5 1.35e5 1.32e5 1.25e5&#39;</div>
<div class="line">  []</div>
<div class="line">  [G]</div>
<div class="line">    type = ScalarLinearInterpolation</div>
<div class="line">    argument = &#39;forces/T&#39;</div>
<div class="line">    abscissa = &#39;300 500&#39;</div>
<div class="line">    ordinate = &#39;7.8e4 7e4&#39;</div>
<div class="line">  []</div>
<div class="line">  [eq1]</div>
<div class="line">    type = ThermalEigenstrain</div>
<div class="line">    reference_temperature = &#39;300&#39;</div>
<div class="line">    CTE = &#39;alpha&#39;</div>
<div class="line">    eigenstrain = &#39;forces/Eg&#39;</div>
<div class="line">  []</div>
<div class="line">  [eq2]</div>
<div class="line">    type = SR2LinearCombination</div>
<div class="line">    from_var = &#39;forces/E forces/Eg&#39;</div>
<div class="line">    to_var = &#39;forces/Ee&#39;</div>
<div class="line">    coefficients = &#39;1 -1&#39;</div>
<div class="line">  []</div>
<div class="line">  [eq3]</div>
<div class="line">    type = LinearIsotropicElasticity</div>
<div class="line">    strain = &#39;forces/Ee&#39;</div>
<div class="line">    stress = &#39;state/S&#39;</div>
<div class="line">    coefficient_types = &#39;BULK_MODULUS SHEAR_MODULUS&#39;</div>
<div class="line">    coefficients = &#39;K G&#39;</div>
<div class="line">  []</div>
<div class="line">  [eq]</div>
<div class="line">    type = ComposedModel</div>
<div class="line">    models = &#39;eq1 eq2 eq3&#39;</div>
<div class="line">  []</div>
<div class="line">[]</div>
</div><!-- fragment --><p>Here, the three temperature-dependent model parameters are defined using <a class="el" href="syntax-models.html#scalarlinearinterpolation">ScalarLinearInterpolation</a>, and their corresponding model names are used to specify model parameters in "eq1" and "eq3". It is important to understand that <b>specifying model parameters by variable coupling alters the model structure</b>. Mathematically, this corresponds to changing   </p><p class="formulaDsp">
\[  \boldsymbol{\sigma} = f(\boldsymbol{\varepsilon}, T; \alpha, K, G)
\]
</p>
<p> to   </p><p class="formulaDsp">
\[  \boldsymbol{\sigma} = f(\boldsymbol{\varepsilon}, T; \mathcal{P}_\alpha, \mathcal{P}_K, \mathcal{P}_G)
\]
</p>
<p> where \( \mathcal{P}_\alpha \), \( \mathcal{P}_K \), and \( \mathcal{P}_G \) denote the parametrizations of \( \alpha \), \( K \), and \( G \), respectively. In our example, these parametrizations are the abscissa and ordinate of the interpolant.</p>
<p>The composed model automatically reflects such restructuring: </p><div class="tabbed"></div><div class="tabbed"><ul>
<li><p class="startli"><b class="tab-title">C++</b> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;neml2/models/Model.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">main()</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">using namespace </span><a class="code hl_namespace" href="namespaceneml2.html">neml2</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> &amp; model = <a class="code hl_function" href="namespaceneml2.html#a1e499dee97d6a66663f60dd4a65b9f1a">load_model</a>(<span class="stringliteral">&quot;input3.i&quot;</span>, <span class="stringliteral">&quot;eq&quot;</span>);</div>
<div class="line">  std::cout &lt;&lt; model &lt;&lt; std::endl;</div>
<div class="line">}</div>
</div><!-- fragment --><p class="startli">Output: </p><div class="fragment"><div class="line">Name:       eq</div>
<div class="line">Input:      forces/E [SR2]</div>
<div class="line">            forces/T [Scalar]</div>
<div class="line">Output:     state/S [SR2]</div>
<div class="line">Parameters: G_X [Scalar][Float][cpu]</div>
<div class="line">            G_Y [Scalar][Float][cpu]</div>
<div class="line">            K_X [Scalar][Float][cpu]</div>
<div class="line">            K_Y [Scalar][Float][cpu]</div>
<div class="line">            alpha_X [Scalar][Float][cpu]</div>
<div class="line">            alpha_Y [Scalar][Float][cpu]</div>
<div class="line">Buffers:    eq1_T0 [Scalar][Float][cpu]</div>
<div class="line">            eq2_c_0 [Scalar][Float][cpu]</div>
<div class="line">            eq2_c_1 [Scalar][Float][cpu]</div>
</div><!-- fragment --></li>
<li><p class="startli"><b class="tab-title">Python</b> </p><div class="fragment"><div class="line"><span class="keyword">import</span> neml2</div>
<div class="line"> </div>
<div class="line">model = <a class="code hl_function" href="namespaceneml2.html#a1e499dee97d6a66663f60dd4a65b9f1a">neml2.load_model</a>(<span class="stringliteral">&quot;input3.i&quot;</span>, <span class="stringliteral">&quot;eq&quot;</span>)</div>
<div class="line">print(model)</div>
</div><!-- fragment --><p class="startli">Output: </p><div class="fragment"><div class="line">Name:       eq</div>
<div class="line">Input:      forces/E [SR2]</div>
<div class="line">            forces/T [Scalar]</div>
<div class="line">Output:     state/S [SR2]</div>
<div class="line">Parameters: G_X [Scalar][Float][cpu]</div>
<div class="line">            G_Y [Scalar][Float][cpu]</div>
<div class="line">            K_X [Scalar][Float][cpu]</div>
<div class="line">            K_Y [Scalar][Float][cpu]</div>
<div class="line">            alpha_X [Scalar][Float][cpu]</div>
<div class="line">            alpha_Y [Scalar][Float][cpu]</div>
<div class="line">Buffers:    eq1_T0 [Scalar][Float][cpu]</div>
<div class="line">            eq2_c_0 [Scalar][Float][cpu]</div>
<div class="line">            eq2_c_1 [Scalar][Float][cpu]</div>
</div><!-- fragment --></li>
</ul>
</div><div class="tabbed"></div><p>When the referenced model has more than one output variables, the variable specification becomes ambiguous. A more precise variable specifier in the form of <code>&lt;model-name&gt;.&lt;variable-name&gt;</code> can be used to remove such ambiguity. For example, although unncessary (as <a class="el" href="syntax-models.html#scalarlinearinterpolation">ScalarLinearInterpolation</a> defines one and only one output variable), the above example input is equivalent to </p><div class="fragment"><div class="line">[Models]</div>
<div class="line">  [alpha]</div>
<div class="line">    type = ScalarLinearInterpolation</div>
<div class="line">    argument = &#39;forces/T&#39;</div>
<div class="line">    abscissa = &#39;300 400 500&#39;</div>
<div class="line">    ordinate = &#39;1e-5 1.5e-5 1.8e-5&#39;</div>
<div class="line">  []</div>
<div class="line">  [K]</div>
<div class="line">    type = ScalarLinearInterpolation</div>
<div class="line">    argument = &#39;forces/T&#39;</div>
<div class="line">    abscissa = &#39;300 350 400 450&#39;</div>
<div class="line">    ordinate = &#39;1.4e5 1.35e5 1.32e5 1.25e5&#39;</div>
<div class="line">  []</div>
<div class="line">  [G]</div>
<div class="line">    type = ScalarLinearInterpolation</div>
<div class="line">    argument = &#39;forces/T&#39;</div>
<div class="line">    abscissa = &#39;300 500&#39;</div>
<div class="line">    ordinate = &#39;7.8e4 7e4&#39;</div>
<div class="line">  []</div>
<div class="line">  [eq1]</div>
<div class="line">    type = ThermalEigenstrain</div>
<div class="line">    reference_temperature = &#39;300&#39;</div>
<div class="line">    CTE = &#39;alpha.parameters/alpha&#39;</div>
<div class="line">    eigenstrain = &#39;forces/Eg&#39;</div>
<div class="line">  []</div>
<div class="line">  [eq2]</div>
<div class="line">    type = SR2LinearCombination</div>
<div class="line">    from_var = &#39;forces/E forces/Eg&#39;</div>
<div class="line">    to_var = &#39;forces/Ee&#39;</div>
<div class="line">    coefficients = &#39;1 -1&#39;</div>
<div class="line">  []</div>
<div class="line">  [eq3]</div>
<div class="line">    type = LinearIsotropicElasticity</div>
<div class="line">    strain = &#39;forces/Ee&#39;</div>
<div class="line">    stress = &#39;state/S&#39;</div>
<div class="line">    coefficient_types = &#39;BULK_MODULUS SHEAR_MODULUS&#39;</div>
<div class="line">    coefficients = &#39;K.parameters/K G.parameters/G&#39;</div>
<div class="line">  []</div>
<div class="line">  [eq]</div>
<div class="line">    type = ComposedModel</div>
<div class="line">    models = &#39;eq1 eq2 eq3&#39;</div>
<div class="line">  []</div>
<div class="line">[]</div>
</div><!-- fragment --><p>Finally, a special form of variable specifier can be used to effectively transform a model parameter into an <b>input variable</b>. For example, the following input file converts the coefficient of thermal expansion into an input variable. </p><div class="fragment"><div class="line">[Models]</div>
<div class="line">  [K]</div>
<div class="line">    type = ScalarLinearInterpolation</div>
<div class="line">    argument = &#39;forces/T&#39;</div>
<div class="line">    abscissa = &#39;300 350 400 450&#39;</div>
<div class="line">    ordinate = &#39;1.4e5 1.35e5 1.32e5 1.25e5&#39;</div>
<div class="line">  []</div>
<div class="line">  [G]</div>
<div class="line">    type = ScalarLinearInterpolation</div>
<div class="line">    argument = &#39;forces/T&#39;</div>
<div class="line">    abscissa = &#39;300 500&#39;</div>
<div class="line">    ordinate = &#39;7.8e4 7e4&#39;</div>
<div class="line">  []</div>
<div class="line">  [eq1]</div>
<div class="line">    type = ThermalEigenstrain</div>
<div class="line">    reference_temperature = &#39;300&#39;</div>
<div class="line">    CTE = &#39;forces/alpha&#39;</div>
<div class="line">    eigenstrain = &#39;forces/Eg&#39;</div>
<div class="line">  []</div>
<div class="line">  [eq2]</div>
<div class="line">    type = SR2LinearCombination</div>
<div class="line">    from_var = &#39;forces/E forces/Eg&#39;</div>
<div class="line">    to_var = &#39;forces/Ee&#39;</div>
<div class="line">    coefficients = &#39;1 -1&#39;</div>
<div class="line">  []</div>
<div class="line">  [eq3]</div>
<div class="line">    type = LinearIsotropicElasticity</div>
<div class="line">    strain = &#39;forces/Ee&#39;</div>
<div class="line">    stress = &#39;state/S&#39;</div>
<div class="line">    coefficient_types = &#39;BULK_MODULUS SHEAR_MODULUS&#39;</div>
<div class="line">    coefficients = &#39;K G&#39;</div>
<div class="line">  []</div>
<div class="line">  [eq]</div>
<div class="line">    type = ComposedModel</div>
<div class="line">    models = &#39;eq1 eq2 eq3&#39;</div>
<div class="line">  []</div>
<div class="line">[]</div>
</div><!-- fragment --><p> Again, NEML2 automatically reflects such change in model structure:</p>
<div class="tabbed"></div><div class="tabbed"><ul>
<li><p class="startli"><b class="tab-title">C++</b> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;neml2/models/Model.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">main()</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">using namespace </span><a class="code hl_namespace" href="namespaceneml2.html">neml2</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> &amp; model = <a class="code hl_function" href="namespaceneml2.html#a1e499dee97d6a66663f60dd4a65b9f1a">load_model</a>(<span class="stringliteral">&quot;input4.i&quot;</span>, <span class="stringliteral">&quot;eq&quot;</span>);</div>
<div class="line">  std::cout &lt;&lt; model &lt;&lt; std::endl;</div>
<div class="line">}</div>
</div><!-- fragment --><p class="startli">Output: </p><div class="fragment"><div class="line">Name:       eq</div>
<div class="line">Input:      forces/E [SR2]</div>
<div class="line">            forces/T [Scalar]</div>
<div class="line">            forces/alpha [Scalar]</div>
<div class="line">Output:     state/S [SR2]</div>
<div class="line">Parameters: G_X [Scalar][Float][cpu]</div>
<div class="line">            G_Y [Scalar][Float][cpu]</div>
<div class="line">            K_X [Scalar][Float][cpu]</div>
<div class="line">            K_Y [Scalar][Float][cpu]</div>
<div class="line">Buffers:    eq1_T0 [Scalar][Float][cpu]</div>
<div class="line">            eq2_c_0 [Scalar][Float][cpu]</div>
<div class="line">            eq2_c_1 [Scalar][Float][cpu]</div>
</div><!-- fragment --></li>
<li><p class="startli"><b class="tab-title">Python</b> </p><div class="fragment"><div class="line"><span class="keyword">import</span> neml2</div>
<div class="line"> </div>
<div class="line">model = <a class="code hl_function" href="namespaceneml2.html#a1e499dee97d6a66663f60dd4a65b9f1a">neml2.load_model</a>(<span class="stringliteral">&quot;input4.i&quot;</span>, <span class="stringliteral">&quot;eq&quot;</span>)</div>
<div class="line">print(model)</div>
</div><!-- fragment --><p class="startli">Output: </p><div class="fragment"><div class="line">Name:       eq</div>
<div class="line">Input:      forces/E [SR2]</div>
<div class="line">            forces/T [Scalar]</div>
<div class="line">            forces/alpha [Scalar]</div>
<div class="line">Output:     state/S [SR2]</div>
<div class="line">Parameters: G_X [Scalar][Float][cpu]</div>
<div class="line">            G_Y [Scalar][Float][cpu]</div>
<div class="line">            K_X [Scalar][Float][cpu]</div>
<div class="line">            K_Y [Scalar][Float][cpu]</div>
<div class="line">Buffers:    eq1_T0 [Scalar][Float][cpu]</div>
<div class="line">            eq2_c_0 [Scalar][Float][cpu]</div>
<div class="line">            eq2_c_1 [Scalar][Float][cpu]</div>
</div><!-- fragment --></li>
</ul>
</div><div class="tabbed"></div><div class="section_buttons"></div><div class="section_buttons"><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Previous   </th><th class="markdownTableHeadRight">Next    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="tutorials-models-model-composition.html">Model composition</a>   </td><td class="markdownTableBodyRight"><a class="el" href="tutorials-models-implicit-model.html">Implicit model</a>   </td></tr>
</table>
</div><div class="section_buttons"></div> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
