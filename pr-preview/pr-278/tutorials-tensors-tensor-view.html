<!-- HTML header for doxygen 1.13.2-->
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=11" />
  <meta name="generator" content="Doxygen 1.12.0" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>NEML2: Tensor view</title>
  <link href="tabs.css" rel="stylesheet" type="text/css" />
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <script type="text/javascript" src="clipboard.js"></script>
  <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/javascript">
window.MathJax = {
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  }
};
window.MathJax = {
  loader: {load: ['[tex]/ams', '[tex]/physics', '[tex]/boldsymbol']},
  tex: {packages: {'[+]': ['ams', 'physics', 'boldsymbol']},
        tags: 'ams'}
};
</script>
<script type="text/javascript" id="MathJax-script" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-tabs.js" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
  <script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
  <script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
  <script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
  <!-- Demo animations -->
  <script type="text/javascript" src="anime.min.js"></script>
  <script type="text/javascript" src="work-dispatcher.js"></script>
  <script type="text/javascript" src="static-hybrid-scheduler.js"></script>
  <script type="text/javascript" src="simple-scheduler-demo.js"></script>
  <script type="text/javascript" src="static-hybrid-scheduler-demo.js"></script>
  <script type="text/javascript">
    DoxygenAwesomeDarkModeToggle.init();
    DoxygenAwesomeParagraphLink.init();
    DoxygenAwesomeInteractiveToc.init();
    DoxygenAwesomeTabs.init();
    SimpleSchedulerDemo.init();
    StaticHybridSchedulerDemo.init();
  </script>
</head>
<body>
    <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
      <div id="titlearea">
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr id="projectrow">
              <td id="projectalign">
                <div id="projectname">NEML2<span
                    id="projectnumber">&#160;2.0.0</span>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('tutorials-tensors-tensor-view.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Tensor view</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul>
  <li class="level1">
    <a href="#autotoc_md158">View versus copy</a>
  </li>
  <li class="level1">
    <a href="#autotoc_md159">Who touched my data?</a>
  </li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_content_2tutorials_2tensors_2tensor__view_2main"></a></p>
<h1><a class="anchor" id="autotoc_md158"></a>
View versus copy</h1>
<p>NEML2 allows a tensor to be a view of an existing tensor. As the name suggests, a tensor view shares the same underlying data with the tensor it is viewing into. In other words, supporting tensor view avoids data copy. Moreover, tensor views optionally (and often) reinterpret the shape and/or striding of the original data, allowing for fast and memory efficient reshaping, slicing, and element-wise operations.</p>
<dl class="section remark"><dt>Remarks</dt><dd>Tensor views enable efficient assembly of implicit systems.</dd></dl>
<p>In fact, all indexing mechanisms covered in the <a class="el" href="tutorials-tensors-indexing.html">previous tutorial</a> are creating tensor views, i.e., zero copy, negligible allocation. In addition to those indexing API, NEML2 also provides flexible tensor reshaping API (documented in <a class="el" href="classneml2_1_1TensorBase.html" title="NEML2&#39;s enhanced tensor type.">neml2::TensorBase</a>).</p>
<h1><a class="anchor" id="autotoc_md159"></a>
Who touched my data?</h1>
<p>Tensor views avoid explicit data copying, which means:</p><ul>
<li>Modification in the original data will be reflected by the tensor view</li>
<li>Modifying data viewed by the tensor view will alter the original data</li>
</ul>
<p>It is therefore important to understand the difference between view and copy, and when to declare ownership (copy, or clone) of the original data.</p>
<p>The following example demonstrates the two bullet points, i.e., "change in original data" &lt;-&gt; "change in data viewed by the tensor view".</p>
<div class="tabbed"></div><div class="tabbed"><ul>
<li><p class="startli"><b class="tab-title">C++</b> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;neml2/tensors/Tensor.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespaceneml2.html">neml2</a>;</div>
<div class="line"><span class="keyword">using namespace </span>indexing;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">main()</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// Create a tensor with shape (; 4, 3) filled with zeros</span></div>
<div class="line">  <span class="keyword">auto</span> a = Tensor::zeros({4, 3});</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;a =\n&quot;</span> &lt;&lt; a &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// b is a view into the first row and the third row of a</span></div>
<div class="line">  <span class="keyword">auto</span> b = a.base_index({Slice(None, None, 2)});</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;b =\n&quot;</span> &lt;&lt; <a class="code hl_variable" href="namespaceneml2_1_1crystallography_1_1crystal__symmetry__operators.html#aa93a189fb7bbbf87be54bcc7bd11bb6f">b</a> &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Modification in a is reflected in b</span></div>
<div class="line">  <a class="code hl_variable" href="namespaceneml2_1_1crystallography_1_1crystal__symmetry__operators.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> += 1.0;</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;\nAfter first modification&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;a =\n&quot;</span> &lt;&lt; <a class="code hl_variable" href="namespaceneml2_1_1crystallography_1_1crystal__symmetry__operators.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> &lt;&lt; std::endl;</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;b =\n&quot;</span> &lt;&lt; <a class="code hl_variable" href="namespaceneml2_1_1crystallography_1_1crystal__symmetry__operators.html#aa93a189fb7bbbf87be54bcc7bd11bb6f">b</a> &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Modification in data viewed by b is reflected in a</span></div>
<div class="line">  <a class="code hl_variable" href="namespaceneml2_1_1crystallography_1_1crystal__symmetry__operators.html#aa93a189fb7bbbf87be54bcc7bd11bb6f">b</a> += 1.0;</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;\nAfter second modification&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;a =\n&quot;</span> &lt;&lt; <a class="code hl_variable" href="namespaceneml2_1_1crystallography_1_1crystal__symmetry__operators.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> &lt;&lt; std::endl;</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;b =\n&quot;</span> &lt;&lt; <a class="code hl_variable" href="namespaceneml2_1_1crystallography_1_1crystal__symmetry__operators.html#aa93a189fb7bbbf87be54bcc7bd11bb6f">b</a> &lt;&lt; std::endl;</div>
<div class="line">}</div>
<div class="ttc" id="anamespaceneml2_1_1crystallography_1_1crystal__symmetry__operators_html_a188caae18b60b66f9f44214c7e28ac1f"><div class="ttname"><a href="namespaceneml2_1_1crystallography_1_1crystal__symmetry__operators.html#a188caae18b60b66f9f44214c7e28ac1f">neml2::crystallography::crystal_symmetry_operators::a</a></div><div class="ttdeci">constexpr double a</div><div class="ttdef"><b>Definition</b> crystallography.h:36</div></div>
<div class="ttc" id="anamespaceneml2_1_1crystallography_1_1crystal__symmetry__operators_html_aa93a189fb7bbbf87be54bcc7bd11bb6f"><div class="ttname"><a href="namespaceneml2_1_1crystallography_1_1crystal__symmetry__operators.html#aa93a189fb7bbbf87be54bcc7bd11bb6f">neml2::crystallography::crystal_symmetry_operators::b</a></div><div class="ttdeci">constexpr double b</div><div class="ttdef"><b>Definition</b> crystallography.h:37</div></div>
<div class="ttc" id="anamespaceneml2_html"><div class="ttname"><a href="namespaceneml2.html">neml2</a></div><div class="ttdef"><b>Definition</b> DiagnosticsInterface.cxx:29</div></div>
</div><!-- fragment --><p class="startli">Output: </p><div class="fragment"><div class="line">a =</div>
<div class="line"> 0  0  0</div>
<div class="line"> 0  0  0</div>
<div class="line"> 0  0  0</div>
<div class="line"> 0  0  0</div>
<div class="line">[ CPUFloatType{4,3} ]</div>
<div class="line">b =</div>
<div class="line"> 0  0  0</div>
<div class="line"> 0  0  0</div>
<div class="line">[ CPUFloatType{2,3} ]</div>
<div class="line"> </div>
<div class="line">After first modification</div>
<div class="line">a =</div>
<div class="line"> 1  1  1</div>
<div class="line"> 1  1  1</div>
<div class="line"> 1  1  1</div>
<div class="line"> 1  1  1</div>
<div class="line">[ CPUFloatType{4,3} ]</div>
<div class="line">b =</div>
<div class="line"> 1  1  1</div>
<div class="line"> 1  1  1</div>
<div class="line">[ CPUFloatType{2,3} ]</div>
<div class="line"> </div>
<div class="line">After second modification</div>
<div class="line">a =</div>
<div class="line"> 2  2  2</div>
<div class="line"> 1  1  1</div>
<div class="line"> 2  2  2</div>
<div class="line"> 1  1  1</div>
<div class="line">[ CPUFloatType{4,3} ]</div>
<div class="line">b =</div>
<div class="line"> 2  2  2</div>
<div class="line"> 2  2  2</div>
<div class="line">[ CPUFloatType{2,3} ]</div>
</div><!-- fragment --></li>
<li><p class="startli"><b class="tab-title">Python</b> </p><div class="fragment"><div class="line"><span class="keyword">from</span> neml2.tensors <span class="keyword">import</span> Tensor</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Create a tensor with shape (; 4, 3) filled with zeros</span></div>
<div class="line">a = Tensor.zeros((4, 3))</div>
<div class="line">print(<span class="stringliteral">&quot;a =&quot;</span>)</div>
<div class="line">print(a)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># b is a view into the first row and the third row of a</span></div>
<div class="line">b = a.base[::2]</div>
<div class="line">print(<span class="stringliteral">&quot;b =&quot;</span>)</div>
<div class="line">print(b)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Modification in a is reflected in b</span></div>
<div class="line">a += 1.0</div>
<div class="line">print(<span class="stringliteral">&quot;\nAfter first modification&quot;</span>)</div>
<div class="line">print(<span class="stringliteral">&quot;a =&quot;</span>)</div>
<div class="line">print(a)</div>
<div class="line">print(<span class="stringliteral">&quot;b =&quot;</span>)</div>
<div class="line">print(b)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Modification in data viewed by b is reflected in a</span></div>
<div class="line">b += 1.0</div>
<div class="line">print(<span class="stringliteral">&quot;\nAfter second modification&quot;</span>)</div>
<div class="line">print(<span class="stringliteral">&quot;a =&quot;</span>)</div>
<div class="line">print(a)</div>
<div class="line">print(<span class="stringliteral">&quot;b =&quot;</span>)</div>
<div class="line">print(b)</div>
</div><!-- fragment --><p class="startli">Output: </p><div class="fragment"><div class="line">a =</div>
<div class="line"> 0  0  0</div>
<div class="line"> 0  0  0</div>
<div class="line"> 0  0  0</div>
<div class="line"> 0  0  0</div>
<div class="line">[ CPUDoubleType{4,3} ]</div>
<div class="line">&lt;Tensor of shape [][4, 3]&gt;</div>
<div class="line">b =</div>
<div class="line"> 0  0  0</div>
<div class="line"> 0  0  0</div>
<div class="line">[ CPUDoubleType{2,3} ]</div>
<div class="line">&lt;Tensor of shape [][2, 3]&gt;</div>
<div class="line"> </div>
<div class="line">After first modification</div>
<div class="line">a =</div>
<div class="line"> 1  1  1</div>
<div class="line"> 1  1  1</div>
<div class="line"> 1  1  1</div>
<div class="line"> 1  1  1</div>
<div class="line">[ CPUDoubleType{4,3} ]</div>
<div class="line">&lt;Tensor of shape [][4, 3]&gt;</div>
<div class="line">b =</div>
<div class="line"> 1  1  1</div>
<div class="line"> 1  1  1</div>
<div class="line">[ CPUDoubleType{2,3} ]</div>
<div class="line">&lt;Tensor of shape [][2, 3]&gt;</div>
<div class="line"> </div>
<div class="line">After second modification</div>
<div class="line">a =</div>
<div class="line"> 2  2  2</div>
<div class="line"> 1  1  1</div>
<div class="line"> 2  2  2</div>
<div class="line"> 1  1  1</div>
<div class="line">[ CPUDoubleType{4,3} ]</div>
<div class="line">&lt;Tensor of shape [][4, 3]&gt;</div>
<div class="line">b =</div>
<div class="line"> 2  2  2</div>
<div class="line"> 2  2  2</div>
<div class="line">[ CPUDoubleType{2,3} ]</div>
<div class="line">&lt;Tensor of shape [][2, 3]&gt;</div>
</div><!-- fragment --></li>
</ul>
</div><div class="tabbed"></div><dl class="section note"><dt>Note</dt><dd>The same statements/rules still hold when multiple tensor views are viewing into the same underlying data, even if they are views of different regions.</dd></dl>
<div class="section_buttons"></div><div class="section_buttons"><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Previous   </th><th class="markdownTableHeadRight">Next    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="tutorials-tensors-indexing.html">Indexing</a>   </td><td class="markdownTableBodyRight"><a class="el" href="tutorials-tensors-broadcasting.html">Broadcasting</a>   </td></tr>
</table>
</div><div class="section_buttons"></div> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
