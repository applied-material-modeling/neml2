<!-- HTML header for doxygen 1.13.2-->
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=11" />
  <meta name="generator" content="Doxygen 1.12.0" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>NEML2: NEML2</title>
  <link href="tabs.css" rel="stylesheet" type="text/css" />
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <script type="text/javascript" src="clipboard.js"></script>
  <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/javascript">
window.MathJax = {
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  }
};
window.MathJax = {
  loader: {load: ['[tex]/ams', '[tex]/physics', '[tex]/boldsymbol']},
  tex: {packages: {'[+]': ['ams', 'physics', 'boldsymbol']},
        tags: 'ams'}
};
</script>
<script type="text/javascript" id="MathJax-script" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-tabs.js" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
  <script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
  <script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
  <script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
  <!-- Demo animations -->
  <script type="text/javascript" src="anime.min.js"></script>
  <script type="text/javascript" src="work-dispatcher.js"></script>
  <script type="text/javascript" src="static-hybrid-scheduler.js"></script>
  <script type="text/javascript" src="simple-scheduler-demo.js"></script>
  <script type="text/javascript" src="static-hybrid-scheduler-demo.js"></script>
  <script type="text/javascript">
    DoxygenAwesomeDarkModeToggle.init();
    DoxygenAwesomeParagraphLink.init();
    DoxygenAwesomeInteractiveToc.init();
    DoxygenAwesomeTabs.init();
    SimpleSchedulerDemo.init();
    StaticHybridSchedulerDemo.init();
  </script>
</head>
<body>
    <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
      <div id="titlearea">
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr id="projectrow">
              <td id="projectalign">
                <div id="projectname">NEML2<span
                    id="projectnumber">&#160;2.0.0</span>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('index.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">NEML2 </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md__2home_2runner_2work_2neml2_2neml2_2README"></a></p>
<div class="image">
<img src="cover_min.png" alt=""/>
</div>
    <p><a href="https://applied-material-modeling.github.io/neml2/"><img src="https://github.com/applied-material-modeling/neml2/actions/workflows/build_docs.yml/badge.svg?branch=main" alt="Documentation" style="pointer-events: none;" class="inline"/></a> <a href="https://github.com/applied-material-modeling/neml2/actions/workflows/cpp.yml"><img src="https://github.com/applied-material-modeling/neml2/actions/workflows/cpp.yml/badge.svg?branch=main" alt="C++ backend testing" style="pointer-events: none;" class="inline"/></a> <a href="https://github.com/applied-material-modeling/neml2/actions/workflows/python.yml"><img src="https://github.com/applied-material-modeling/neml2/actions/workflows/python.yml/badge.svg?branch=main" alt="Python package testing" style="pointer-events: none;" class="inline"/></a></p>
<h1><a class="anchor" id="autotoc_md1"></a>
Overview</h1>
<h2><a class="anchor" id="autotoc_md2"></a>
The New Engineering Material model Library, version 2</h2>
<p>NEML2 is an offshoot of <a href="https://github.com/Argonne-National-Laboratory/neml">NEML</a>, an earlier material modeling code developed at Argonne National Laboratory. Like its predecessor, NEML2 provides a flexible, modular way to build material models from smaller blocks. Unlike its predecessor, NEML2 vectorizes the material update to efficiently run on GPUs. In addition, NEML2 models can use <a href="https://pytorch.org/cppdocs/">PyTorch</a> as the backend to provide first-class support for automatic differentiation, operator fusion, lazy tensor evaluation, inference mode, etc.</p>
<p>NEML2 is provided as open source software under a MIT <a href="https://raw.githubusercontent.com/applied-material-modeling/neml2/main/LICENSE">license</a>.</p>
<blockquote class="doxtable">
<p>&zwj;<b>Disclaimer</b></p>
<p>NEML2 is <em>not</em> a database of material models. There are many example material models in the library for testing and verification purposes. These models do not represent the response of any actual material. </p>
</blockquote>
<h2><a class="anchor" id="autotoc_md3"></a>
Quick installation</h2>
<p>Building should be as easy as cloning the repository, configuring with CMake, compiling with <code>make</code>, and installing with <code>make install</code>. Refer to the <a href="https://applied-material-modeling.github.io/neml2/install.html">installation guide</a> for more detailed instructions and finer control over various dependencies as well as other build customization.</p>
<h2><a class="anchor" id="autotoc_md4"></a>
Features and design philosophy</h2>
<h3>Vectorization</h3>
<p>NEML2 models can be vectorized, meaning that a large <em>batch</em> of material models can be evaluated simultaneously. The vectorized models can be evaluated on either CPUs or GPUs/other accelerators. Moreover, NEML2 provides a unified implementation and user interface, for both developers and end users, that work on all supported devices.</p>
<p>The table below compares three approaches for solving the same problem: a crystal plasticity simulation using the Taylor method, with 50,000 grains and 250 load steps. The first approach is using NEML (the predecessor of NEML2) which is a CPU-only, fully threaded library. The second and the third approaches use NEML2, evaluating the same model on CPU and GPU (CUDA), respectively.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone">Device   </th><th class="markdownTableHeadNone">Wall time (s)   </th><th class="markdownTableHeadLeft">Specs    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">NEML   </td><td class="markdownTableBodyNone">CPU   </td><td class="markdownTableBodyNone">42,500   </td><td class="markdownTableBodyLeft">Intel Xeon Gold 6346 CPU with 32 threads    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">NEML2   </td><td class="markdownTableBodyNone">CPU   </td><td class="markdownTableBodyNone">15,000   </td><td class="markdownTableBodyLeft">Intel Xeon Gold 6346 CPU with 32 threads    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">NEML2   </td><td class="markdownTableBodyNone">GPU   </td><td class="markdownTableBodyNone">68   </td><td class="markdownTableBodyLeft">1 NVIDIA RTX A5000 GPUs    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">34   </td><td class="markdownTableBodyLeft">2 NVIDIA RTX A5000 GPUs   </td></tr>
</table>
<p>NEML2 is more than 2x faster than NEML on CPU, owing to more comprehensive threading and vectorization as well as Just-In-Time compilation. In this case, GPUs further speed up the calculation by more than 400 times.</p>
<h3>Multiphysics coupling</h3>
<p>NEML2 is not tied to any underlying problem physics, e.g., solid mechanics, heat transfer, fluid dynamics, electromagnetics, etc. Current modules cover thermal and mechanical material models, but the framework <em>can</em> be used to implement a wider range of constitutive models. For coupled problems, NEML2 will return the exact, coupled Jacobian entries required to achieve optimal convergence. NEML2 can be used together with <a href="https://mooseframework.inl.gov/">MOOSE</a>, a Multiphysics finite element framework, to solve partial differential equations.</p>
<h3>Modularity and flexibility</h3>
<p>NEML2 material models are modular – they are built up from smaller pieces into a complete model. NEML2 offers an extremely flexible way of composing models. Each individual model only defines the forward operator (and optionally its derivative) with a given set of inputs and outputs. When a set of models are <em>composed</em> together to form a composite model, dependencies among different models are automatically detected, registered, and resolved. The user has <em>complete control</em> over how NEML2 evaluates a set of models.</p>
<h3>Extensibility</h3>
<p>The library is structured so that adding a new feature to an existing material model should be as simple as possible and require as little code as possible. In line with this philosophy, the library only requires new components to provide a few partial derivatives, and NEML2 uses this information to automatically assemble the overall Jacobian using chain rule and provide the algorithmic tangent needed to integrate the model into an implicit finite element framework. Moreover, in NEML2, implementations can forgo providing these partial derivatives, and NEML2 will calculate them with automatic differentiation.</p>
<h3>Friendly user interfaces</h3>
<p>There are three general ways of interfacing with NEML2 material models: the compiled C++ library, the Python package, and the runner. In all interfaces, creation and archival of NEML2 models rely on input files written in the hierarchical <a href="https://github.com/idaholab/moose/tree/master/framework/contrib/hit">HIT</a> format. NEML2 models created using the Python bindings are fully interoperable with PyTorch tensors and modules, meaning that NEML2 material models can seamlessly work with popular machine learning frameworks developed using PyTorch.</p>
<h3>Strict quality assurance</h3>
<p>NEML2 is developed under a strict quality assurance program. Because the NEML2 distributions do not provide full, parameterized models for any actual materials, ensuring the quality of the library is a verification problem – testing to make sure that NEML2 is correctly implementing the mathematical models – rather than a validation problem of comparing the results of a model to an experiment. In NEML2, this verification is done with extensive unit testing. Additional regression tests are set up for each combination of material model to ensure result consistency across releases.</p>
<h2><a class="anchor" id="autotoc_md5"></a>
Citing NEML2</h2>
<div class="fragment"><div class="line">@article{neml2_softwarex_2025,</div>
<div class="line">  title = {NEML2: An efficient and modular multiphysics constitutive modeling library for hybrid computing environments},</div>
<div class="line">  journal = {SoftwareX},</div>
<div class="line">  volume = {31},</div>
<div class="line">  pages = {102302},</div>
<div class="line">  year = {2025},</div>
<div class="line">  issn = {2352-7110},</div>
<div class="line">  doi = {https://doi.org/10.1016/j.softx.2025.102302},</div>
<div class="line">  url = {https://www.sciencedirect.com/science/article/pii/S2352711025002687},</div>
<div class="line">  author = {Tianchen Hu and Mark C. Messner},</div>
<div class="line">  keywords = {Constitutive model, GPU, Multiphysics}</div>
<div class="line">}</div>
</div><!-- fragment --><div class="fragment"><div class="line">@techreport{neml2osti2440430,</div>
<div class="line">  author      = {Tianchen Hu and Mark C.  Messner and Daniel Schwen and Lynn B.  Munday and Dewen Yushu},</div>
<div class="line">  title       = {NEML2: A High Performance Library for Constitutive Modeling},</div>
<div class="line">  institution = {Argonne National Laboratory (ANL), Argonne, IL (United States); Idaho National Laboratory (INL), Idaho Falls, ID (United States)},</div>
<div class="line">  doi         = {10.2172/2440430},</div>
<div class="line">  url         = {https://www.osti.gov/biblio/2440430},</div>
<div class="line">  place       = {United States},</div>
<div class="line">  year        = {2024},</div>
<div class="line">  month       = {09}</div>
<div class="line">}</div>
</div><!-- fragment --><div class="fragment"><div class="line">@misc{neml2osti1961125,</div>
<div class="line">  author = {MESSNER, MARK and HU, TIANCHEN and US DOE NE-NEAMS},</div>
<div class="line">  title  = {NEML2 - THE NEW ENGINEERING MATERIAL MODEL LIBRARY, VERSION 2},</div>
<div class="line">  doi    = {10.11578/dc.20230314.1},</div>
<div class="line">  url    = {https://www.osti.gov/biblio/1961125},</div>
<div class="line">  place  = {United States},</div>
<div class="line">  year   = {2023},</div>
<div class="line">  month  = {01}</div>
<div class="line">}</div>
</div><!-- fragment --> </div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"></a>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
