<!-- HTML header for doxygen 1.13.2-->
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=11" />
  <meta name="generator" content="Doxygen 1.16.1" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>NEML2: NEML2PyzagModel Class Reference</title>
  <link href="tabs.css" rel="stylesheet" type="text/css" />
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <script type="text/javascript" src="clipboard.js"></script>
  <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/javascript">
window.MathJax = {
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  }
};
window.MathJax = {
  loader: {load: ['[tex]/ams', '[tex]/physics', '[tex]/boldsymbol']},
  tex: {packages: {'[+]': ['ams', 'physics', 'boldsymbol']},
        tags: 'ams'}
};
</script>
<script type="text/javascript" id="MathJax-script" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-tabs.js" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
  <script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
  <script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
  <script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
  <!-- Demo animations -->
  <script type="text/javascript" src="anime.min.js"></script>
  <script type="text/javascript" src="work-dispatcher.js"></script>
  <script type="text/javascript" src="static-hybrid-scheduler.js"></script>
  <script type="text/javascript" src="simple-scheduler-demo.js"></script>
  <script type="text/javascript" src="static-hybrid-scheduler-demo.js"></script>
  <script type="text/javascript">
    DoxygenAwesomeDarkModeToggle.init();
    DoxygenAwesomeParagraphLink.init();
    DoxygenAwesomeInteractiveToc.init();
    DoxygenAwesomeTabs.init();
    SimpleSchedulerDemo.init();
    StaticHybridSchedulerDemo.init();
  </script>
</head>
<body>
    <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
      <div id="titlearea">
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr id="projectrow">
              <td id="projectalign">
                <div id="projectname">NEML2<span
                    id="projectnumber">&#160;2.0.0</span>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <!-- end header part -->
<!-- Generated by Doxygen 1.16.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('classneml2_1_1pyzag_1_1interface_1_1NEML2PyzagModel.html','','classneml2_1_1pyzag_1_1interface_1_1NEML2PyzagModel-members'); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classneml2_1_1pyzag_1_1interface_1_1NEML2PyzagModel-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">NEML2PyzagModel Class Reference</div></div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Wraps a NEML2 nonlinear system into a `nonlinear.NonlinearRecursiveFunction`

Args:
    sys: the NEML2 nonlinear system to wrap

Keyword Args:
    exclude_parameters (list of str): exclude these parameters from being wrapped as a pytorch parameter

Additional args and kwargs are forwarded to NonlinearRecursiveFunction (and hence torch.nn.Module) verbatim
</pre> </div><div class="dynheader">
Inheritance diagram for NEML2PyzagModel:</div>
<div class="dyncontent">
<div class="center"><img src="classneml2_1_1pyzag_1_1interface_1_1NEML2PyzagModel__inherit__graph.png" border="0" usemap="#aNEML2PyzagModel_inherit__map" loading="lazy" alt="Inheritance graph"/></div>
<map name="aNEML2PyzagModel_inherit__map" id="aNEML2PyzagModel_inherit__map">
<area shape="rect" title=" " alt="" coords="147,79,294,104"/>
<area shape="rect" title=" " alt="" coords="5,5,209,31"/>
<area shape="poly" title=" " alt="" coords="139,36,204,76,201,81,136,40"/>
<area shape="rect" title=" " alt="" coords="233,5,437,31"/>
<area shape="poly" title=" " alt="" coords="307,40,241,81,238,76,304,35"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-pub-methods" class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a9c1b409da0f167df93b77d9cf078adc9" id="r_a9c1b409da0f167df93b77d9cf078adc9"><td class="memItemLeft">&#160;</td><td class="memItemRight"><a class="el" href="#a9c1b409da0f167df93b77d9cf078adc9">__init__</a> (self, <a class="el" href="classneml2_1_1core_1_1NonlinearSystem.html">neml2.NonlinearSystem</a> <a class="el" href="#a3186d68ed459909f4d5ce3af8547eb75">sys</a>, *args, list[str] exclude_parameters=[], **kwargs)</td></tr>
<tr class="memitem:a191e25e8a248b6d7817a9313e9fdafb2" id="r_a191e25e8a248b6d7817a9313e9fdafb2"><td class="memItemLeft">int&#160;</td><td class="memItemRight"><a class="el" href="#a191e25e8a248b6d7817a9313e9fdafb2">lookback</a> (self)</td></tr>
<tr class="memitem:a610e370ac6b08eb423ab1aab56e8bd65" id="r_a610e370ac6b08eb423ab1aab56e8bd65"><td class="memItemLeft">&#160;</td><td class="memItemRight"><a class="el" href="#a610e370ac6b08eb423ab1aab56e8bd65">lookback</a> (self, int lookback)</td></tr>
<tr class="memitem:a275dffc664c6501d1091f5bd0fcc6f68" id="r_a275dffc664c6501d1091f5bd0fcc6f68"><td class="memItemLeft">int&#160;</td><td class="memItemRight"><a class="el" href="#a275dffc664c6501d1091f5bd0fcc6f68">nstate</a> (self)</td></tr>
<tr class="memitem:acf51b0af154fd972311057c0bf6fd55c" id="r_acf51b0af154fd972311057c0bf6fd55c"><td class="memItemLeft">int&#160;</td><td class="memItemRight"><a class="el" href="#acf51b0af154fd972311057c0bf6fd55c">nforce</a> (self)</td></tr>
<tr class="memitem:a26cfc528c420175571c1a7645a186455" id="r_a26cfc528c420175571c1a7645a186455"><td class="memItemLeft">tuple[torch.Tensor, torch.Tensor]&#160;</td><td class="memItemRight"><a class="el" href="#a26cfc528c420175571c1a7645a186455">forward</a> (self, torch.Tensor state, torch.Tensor forces)</td></tr>
<tr class="memitem:a2cc1cc3be538582d4449dda4c553e44f" id="r_a2cc1cc3be538582d4449dda4c553e44f"><td class="memItemLeft">&#160;</td><td class="memItemRight"><a class="el" href="#a2cc1cc3be538582d4449dda4c553e44f">__init__</a> (self, <a class="el" href="classneml2_1_1core_1_1NonlinearSystem.html">neml2.core.NonlinearSystem</a> <a class="el" href="#a3186d68ed459909f4d5ce3af8547eb75">sys</a>, *args, list[str] exclude_parameters=list(), **kwargs)</td></tr>
<tr class="memitem:a26cfc528c420175571c1a7645a186455" id="r_a26cfc528c420175571c1a7645a186455"><td class="memItemLeft">tuple[torch.Tensor, torch.Tensor]&#160;</td><td class="memItemRight"><a class="el" href="#a26cfc528c420175571c1a7645a186455">forward</a> (self, torch.Tensor state, torch.Tensor forces)</td></tr>
<tr class="memitem:acf51b0af154fd972311057c0bf6fd55c" id="r_acf51b0af154fd972311057c0bf6fd55c"><td class="memItemLeft">int&#160;</td><td class="memItemRight"><a class="el" href="#acf51b0af154fd972311057c0bf6fd55c">nforce</a> (self)</td></tr>
<tr class="memitem:a275dffc664c6501d1091f5bd0fcc6f68" id="r_a275dffc664c6501d1091f5bd0fcc6f68"><td class="memItemLeft">int&#160;</td><td class="memItemRight"><a class="el" href="#a275dffc664c6501d1091f5bd0fcc6f68">nstate</a> (self)</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-pub-attribs" class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a3186d68ed459909f4d5ce3af8547eb75" id="r_a3186d68ed459909f4d5ce3af8547eb75"><td class="memItemLeft">&#160;</td><td class="memItemRight"><a class="el" href="#a3186d68ed459909f4d5ce3af8547eb75">sys</a> = sys</td></tr>
<tr class="memitem:a508cc3106d2c29fe07dc87cbe3ea6927" id="r_a508cc3106d2c29fe07dc87cbe3ea6927"><td class="memItemLeft">&#160;</td><td class="memItemRight"><a class="el" href="#a508cc3106d2c29fe07dc87cbe3ea6927">model</a> = sys.model()</td></tr>
<tr class="memitem:aa40e846bf593e5f142f4b9884f6bcc6f" id="r_aa40e846bf593e5f142f4b9884f6bcc6f"><td class="memItemLeft">list&#160;</td><td class="memItemRight"><a class="el" href="#aa40e846bf593e5f142f4b9884f6bcc6f">parameter_names</a> = []</td></tr>
<tr class="memitem:a7fd6b03fd5d092bdee10e3297251e52b" id="r_a7fd6b03fd5d092bdee10e3297251e52b"><td class="memItemLeft">&#160;</td><td class="memItemRight"><a class="el" href="#a7fd6b03fd5d092bdee10e3297251e52b">smap</a> = self.sys.umap()</td></tr>
<tr class="memitem:adcd7e38c22c7f3024050998a73b074e8" id="r_adcd7e38c22c7f3024050998a73b074e8"><td class="memItemLeft">&#160;</td><td class="memItemRight"><a class="el" href="#adcd7e38c22c7f3024050998a73b074e8">slayout</a> = self.sys.ulayout()</td></tr>
<tr class="memitem:a012dc2013a9a54ad790e5e4f0ab2dad6" id="r_a012dc2013a9a54ad790e5e4f0ab2dad6"><td class="memItemLeft">list&#160;</td><td class="memItemRight"><a class="el" href="#a012dc2013a9a54ad790e5e4f0ab2dad6">fmap</a> = [v for v in self.sys.gmap() if <a class="el" href="classneml2_1_1core_1_1VariableName.html">VariableName</a>(v).start_with(<a class="el" href="#a2f65bbcb2d2c7ef58453f69b889706dd">FORCES</a>)]</td></tr>
<tr class="memitem:a9c6cc285517f5bcc703d4f4af36546f0" id="r_a9c6cc285517f5bcc703d4f4af36546f0"><td class="memItemLeft">list&#160;</td><td class="memItemRight"><a class="el" href="#a9c6cc285517f5bcc703d4f4af36546f0">flayout</a></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-pub-static-attribs" class="groupheader"><a id="pub-static-attribs" name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:a2f65bbcb2d2c7ef58453f69b889706dd" id="r_a2f65bbcb2d2c7ef58453f69b889706dd"><td class="memItemLeft">str&#160;</td><td class="memItemRight"><a class="el" href="#a2f65bbcb2d2c7ef58453f69b889706dd">FORCES</a> = 'forces'</td></tr>
<tr class="memitem:ac5ff485b7df21729aed01a8ade6fdc3b" id="r_ac5ff485b7df21729aed01a8ade6fdc3b"><td class="memItemLeft">str&#160;</td><td class="memItemRight"><a class="el" href="#ac5ff485b7df21729aed01a8ade6fdc3b">OLD_FORCES</a> = 'old_forces'</td></tr>
<tr class="memitem:aedb2960eea276af13468d00e0d71cab7" id="r_aedb2960eea276af13468d00e0d71cab7"><td class="memItemLeft">str&#160;</td><td class="memItemRight"><a class="el" href="#aedb2960eea276af13468d00e0d71cab7">OLD_STATE</a> = 'old_state'</td></tr>
<tr class="memitem:afa5ad3a8e19d4be39c0865720f1966ad" id="r_afa5ad3a8e19d4be39c0865720f1966ad"><td class="memItemLeft">str&#160;</td><td class="memItemRight"><a class="el" href="#afa5ad3a8e19d4be39c0865720f1966ad">PARAMETERS</a> = 'parameters'</td></tr>
<tr class="memitem:ad855e5fdf082549e6f9f35ace3ac0ef2" id="r_ad855e5fdf082549e6f9f35ace3ac0ef2"><td class="memItemLeft">str&#160;</td><td class="memItemRight"><a class="el" href="#ad855e5fdf082549e6f9f35ace3ac0ef2">RESIDUAL</a> = 'residual'</td></tr>
<tr class="memitem:ad05796529f5499cab65861daaa03a7da" id="r_ad05796529f5499cab65861daaa03a7da"><td class="memItemLeft">str&#160;</td><td class="memItemRight"><a class="el" href="#ad05796529f5499cab65861daaa03a7da">STATE</a> = 'state'</td></tr>
<tr class="memitem:a392478988b4565d8886e7b99d2ab3411" id="r_a392478988b4565d8886e7b99d2ab3411"><td class="memItemLeft">list&#160;</td><td class="memItemRight"><a class="el" href="#a392478988b4565d8886e7b99d2ab3411">subaxis_names</a> = ['state', 'old_state', 'forces', 'old_forces', 'residual', 'parameters']</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-pro-methods" class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a07770d00e721194d0a9b1bbcd8e63906" id="r_a07770d00e721194d0a9b1bbcd8e63906"><td class="memItemLeft">&#160;</td><td class="memItemRight"><a class="el" href="#a07770d00e721194d0a9b1bbcd8e63906">_check_model</a> (self)</td></tr>
<tr class="memitem:ac701836d3a81103438e81a229f0c1aa0" id="r_ac701836d3a81103438e81a229f0c1aa0"><td class="memItemLeft">&#160;</td><td class="memItemRight"><a class="el" href="#ac701836d3a81103438e81a229f0c1aa0">_setup_parameters</a> (self, list[str] exclude_parameters)</td></tr>
<tr class="memitem:a85afbc987b0b493d40b50c58e474ee5c" id="r_a85afbc987b0b493d40b50c58e474ee5c"><td class="memItemLeft">&#160;</td><td class="memItemRight"><a class="el" href="#a85afbc987b0b493d40b50c58e474ee5c">_update_parameter_values</a> (self)</td></tr>
<tr class="memitem:a38aad0821f0055638e4f01ca7d96af0d" id="r_a38aad0821f0055638e4f01ca7d96af0d"><td class="memItemLeft">&#160;</td><td class="memItemRight"><a class="el" href="#a38aad0821f0055638e4f01ca7d96af0d">_setup_maps</a> (self)</td></tr>
<tr class="memitem:af9ea75c9b8a6ef11690a4cadc829ef0f" id="r_af9ea75c9b8a6ef11690a4cadc829ef0f"><td class="memItemLeft">&#160;</td><td class="memItemRight"><a class="el" href="#af9ea75c9b8a6ef11690a4cadc829ef0f">_update_sys</a> (self, torch.Tensor state, torch.Tensor forces)</td></tr>
<tr class="memitem:a16d731fef543689f37d6985a7d82e081" id="r_a16d731fef543689f37d6985a7d82e081"><td class="memItemLeft">tuple[<a class="el" href="classneml2_1_1tensors_1_1Tensor.html">neml2.Tensor</a>, <a class="el" href="classneml2_1_1tensors_1_1Tensor.html">neml2.Tensor</a>, <a class="el" href="classneml2_1_1tensors_1_1Tensor.html">neml2.Tensor</a>]&#160;</td><td class="memItemRight"><a class="el" href="#a16d731fef543689f37d6985a7d82e081">_assemble</a> (self, list[<a class="el" href="classneml2_1_1tensors_1_1Tensor.html">neml2.Tensor</a>] A, list[<a class="el" href="classneml2_1_1tensors_1_1Tensor.html">neml2.Tensor</a>] B, list[<a class="el" href="classneml2_1_1tensors_1_1Tensor.html">neml2.Tensor</a>] b)</td></tr>
<tr class="memitem:ad09fedf9ef2504fe76262bc25e924ee7" id="r_ad09fedf9ef2504fe76262bc25e924ee7"><td class="memItemLeft">tuple[torch.Tensor, torch.Tensor]&#160;</td><td class="memItemRight"><a class="el" href="#ad09fedf9ef2504fe76262bc25e924ee7">_adapt_for_pyzag</a> (self, <a class="el" href="classneml2_1_1tensors_1_1Tensor.html">neml2.Tensor</a> r, <a class="el" href="classneml2_1_1tensors_1_1Tensor.html">neml2.Tensor</a> J, <a class="el" href="classneml2_1_1tensors_1_1Tensor.html">neml2.Tensor</a> Jn)</td></tr>
<tr class="memitem:a76d44f5dc7bb52bef31cc40d5fb95d4f" id="r_a76d44f5dc7bb52bef31cc40d5fb95d4f"><td class="memItemLeft">tuple[torch.Tensor, torch.Tensor]&#160;</td><td class="memItemRight"><a class="el" href="#a76d44f5dc7bb52bef31cc40d5fb95d4f">_adapt_for_pyzag</a> (self, <a class="el" href="classneml2_1_1tensors_1_1Tensor.html">neml2.tensors.Tensor</a> r, <a class="el" href="classneml2_1_1tensors_1_1Tensor.html">neml2.tensors.Tensor</a> J, <a class="el" href="classneml2_1_1tensors_1_1Tensor.html">neml2.tensors.Tensor</a> Jn)</td></tr>
<tr class="memitem:ad507527a95abeb558dbbf8f861dc6341" id="r_ad507527a95abeb558dbbf8f861dc6341"><td class="memItemLeft">tuple[<a class="el" href="classneml2_1_1tensors_1_1Tensor.html">neml2.tensors.Tensor</a>, <a class="el" href="classneml2_1_1tensors_1_1Tensor.html">neml2.tensors.Tensor</a>, <a class="el" href="classneml2_1_1tensors_1_1Tensor.html">neml2.tensors.Tensor</a>]&#160;</td><td class="memItemRight"><a class="el" href="#ad507527a95abeb558dbbf8f861dc6341">_assemble</a> (self, list[<a class="el" href="classneml2_1_1tensors_1_1Tensor.html">neml2.tensors.Tensor</a>] A, list[<a class="el" href="classneml2_1_1tensors_1_1Tensor.html">neml2.tensors.Tensor</a>] B, list[<a class="el" href="classneml2_1_1tensors_1_1Tensor.html">neml2.tensors.Tensor</a>] b)</td></tr>
<tr class="memitem:a07770d00e721194d0a9b1bbcd8e63906" id="r_a07770d00e721194d0a9b1bbcd8e63906"><td class="memItemLeft">&#160;</td><td class="memItemRight"><a class="el" href="#a07770d00e721194d0a9b1bbcd8e63906">_check_model</a> (self)</td></tr>
<tr class="memitem:a38aad0821f0055638e4f01ca7d96af0d" id="r_a38aad0821f0055638e4f01ca7d96af0d"><td class="memItemLeft">&#160;</td><td class="memItemRight"><a class="el" href="#a38aad0821f0055638e4f01ca7d96af0d">_setup_maps</a> (self)</td></tr>
<tr class="memitem:ac701836d3a81103438e81a229f0c1aa0" id="r_ac701836d3a81103438e81a229f0c1aa0"><td class="memItemLeft">&#160;</td><td class="memItemRight"><a class="el" href="#ac701836d3a81103438e81a229f0c1aa0">_setup_parameters</a> (self, list[str] exclude_parameters)</td></tr>
<tr class="memitem:a85afbc987b0b493d40b50c58e474ee5c" id="r_a85afbc987b0b493d40b50c58e474ee5c"><td class="memItemLeft">&#160;</td><td class="memItemRight"><a class="el" href="#a85afbc987b0b493d40b50c58e474ee5c">_update_parameter_values</a> (self)</td></tr>
<tr class="memitem:af9ea75c9b8a6ef11690a4cadc829ef0f" id="r_af9ea75c9b8a6ef11690a4cadc829ef0f"><td class="memItemLeft">&#160;</td><td class="memItemRight"><a class="el" href="#af9ea75c9b8a6ef11690a4cadc829ef0f">_update_sys</a> (self, torch.Tensor state, torch.Tensor forces)</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-pro-attribs" class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:aae0fa6572d0acf3ebd0e268473e6c70a" id="r_aae0fa6572d0acf3ebd0e268473e6c70a"><td class="memItemLeft">int&#160;</td><td class="memItemRight"><a class="el" href="#aae0fa6572d0acf3ebd0e268473e6c70a">_lookback</a> = 1</td></tr>
<tr class="memitem:ad99276e7009b9d9737ee44f41e7673f3" id="r_ad99276e7009b9d9737ee44f41e7673f3"><td class="memItemLeft">&#160;</td><td class="memItemRight"><a class="el" href="#ad99276e7009b9d9737ee44f41e7673f3">_sn_to_g_map</a> = _index_map_from_to(snmap, self.sys.gmap())</td></tr>
<tr class="memitem:a345fb5072bc851057c84323ea1ed7e4c" id="r_a345fb5072bc851057c84323ea1ed7e4c"><td class="memItemLeft">&#160;</td><td class="memItemRight"><a class="el" href="#a345fb5072bc851057c84323ea1ed7e4c">_f_to_g_map</a> = _index_map_from_to(self.fmap, self.sys.gmap())</td></tr>
<tr class="memitem:a7b272224a5b701f784df8aa71539eb22" id="r_a7b272224a5b701f784df8aa71539eb22"><td class="memItemLeft">&#160;</td><td class="memItemRight"><a class="el" href="#a7b272224a5b701f784df8aa71539eb22">_fn_to_g_map</a> = _index_map_from_to(fn_map, self.sys.gmap())</td></tr>
<tr class="memitem:aa0f5abfaf45aadb3c1d38cc0d0b3d346" id="r_aa0f5abfaf45aadb3c1d38cc0d0b3d346"><td class="memItemLeft">&#160;</td><td class="memItemRight"><a class="el" href="#aa0f5abfaf45aadb3c1d38cc0d0b3d346">_g_to_sn_map</a> = _index_map_from_to(self.sys.gmap(), snmap)</td></tr>
</table>
<a name="doc-constructors" id="doc-constructors"></a><h2 id="header-doc-constructors" class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a9c1b409da0f167df93b77d9cf078adc9" name="a9c1b409da0f167df93b77d9cf078adc9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c1b409da0f167df93b77d9cf078adc9">&#9670;&#160;</a></span>__init__() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__init__ </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classneml2_1_1core_1_1NonlinearSystem.html">neml2.NonlinearSystem</a></td>          <td class="paramname"><span class="paramname"><em>sys</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*</td>          <td class="paramname"><span class="paramname"><em>args</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">list[str] </td>          <td class="paramname"><span class="paramname"><em>exclude_parameters</em></span><span class="paramdefsep"> = </span><span class="paramdefval">[]</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**</td>          <td class="paramname"><span class="paramname"><em>kwargs</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2cc1cc3be538582d4449dda4c553e44f" name="a2cc1cc3be538582d4449dda4c553e44f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2cc1cc3be538582d4449dda4c553e44f">&#9670;&#160;</a></span>__init__() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__init__ </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classneml2_1_1core_1_1NonlinearSystem.html">neml2.core.NonlinearSystem</a></td>          <td class="paramname"><span class="paramname"><em>sys</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*</td>          <td class="paramname"><span class="paramname"><em>args</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">list[str] </td>          <td class="paramname"><span class="paramname"><em>exclude_parameters</em></span><span class="paramdefsep"> = </span><span class="paramdefval">list()</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**</td>          <td class="paramname"><span class="paramname"><em>kwargs</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Member Function Documentation</h2>
<a id="ad09fedf9ef2504fe76262bc25e924ee7" name="ad09fedf9ef2504fe76262bc25e924ee7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad09fedf9ef2504fe76262bc25e924ee7">&#9670;&#160;</a></span>_adapt_for_pyzag() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> tuple[torch.Tensor, torch.Tensor] _adapt_for_pyzag </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classneml2_1_1tensors_1_1Tensor.html">neml2.Tensor</a></td>          <td class="paramname"><span class="paramname"><em>r</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classneml2_1_1tensors_1_1Tensor.html">neml2.Tensor</a></td>          <td class="paramname"><span class="paramname"><em>J</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classneml2_1_1tensors_1_1Tensor.html">neml2.Tensor</a>
    </td>          <td class="paramname"><span class="paramname"><em>Jn</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Adapt the residual and Jacobians for pyzag

pyzag has additional requirements on residual and Jacobians:
  1. The residual and Jacobians should have the same batch shape
  2. The Jacobians should be square

The second requirement has been taken care of by the previous _assemble call.

Args:
    r (neml2.Tensor): residual
    J (neml2.Tensor): Jacobian
    Jn (neml2.Tensor): Jacobian for the old state

Returns:
    tuple of torch.Tensor: residual, Jacobian
</pre> 
</div>
</div>
<a id="a76d44f5dc7bb52bef31cc40d5fb95d4f" name="a76d44f5dc7bb52bef31cc40d5fb95d4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76d44f5dc7bb52bef31cc40d5fb95d4f">&#9670;&#160;</a></span>_adapt_for_pyzag() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> tuple[torch.Tensor, torch.Tensor] _adapt_for_pyzag </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classneml2_1_1tensors_1_1Tensor.html">neml2.tensors.Tensor</a></td>          <td class="paramname"><span class="paramname"><em>r</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classneml2_1_1tensors_1_1Tensor.html">neml2.tensors.Tensor</a></td>          <td class="paramname"><span class="paramname"><em>J</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classneml2_1_1tensors_1_1Tensor.html">neml2.tensors.Tensor</a></td>          <td class="paramname"><span class="paramname"><em>Jn</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Adapt the residual and Jacobians for pyzag

        pyzag has additional requirements on residual and Jacobians:
          1. The residual and Jacobians should have the same batch shape
          2. The Jacobians should be square

        The second requirement has been taken care of by the previous _assemble call.

        Args:
            r (neml2.Tensor): residual
            J (neml2.Tensor): Jacobian
            Jn (neml2.Tensor): Jacobian for the old state

        Returns:
            tuple of torch.Tensor: residual, Jacobian
</pre> 
</div>
</div>
<a id="a16d731fef543689f37d6985a7d82e081" name="a16d731fef543689f37d6985a7d82e081"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16d731fef543689f37d6985a7d82e081">&#9670;&#160;</a></span>_assemble() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> tuple[<a class="el" href="classneml2_1_1tensors_1_1Tensor.html">neml2.Tensor</a>, <a class="el" href="classneml2_1_1tensors_1_1Tensor.html">neml2.Tensor</a>, <a class="el" href="classneml2_1_1tensors_1_1Tensor.html">neml2.Tensor</a>] _assemble </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">list[<a class="el" href="classneml2_1_1tensors_1_1Tensor.html">neml2.Tensor</a>]</td>          <td class="paramname"><span class="paramname"><em>A</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">list[<a class="el" href="classneml2_1_1tensors_1_1Tensor.html">neml2.Tensor</a>]</td>          <td class="paramname"><span class="paramname"><em>B</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">list[<a class="el" href="classneml2_1_1tensors_1_1Tensor.html">neml2.Tensor</a>]
    </td>          <td class="paramname"><span class="paramname"><em>b</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Assemble the residual and Jacobians from A, B, and b

Args:
    A (list of neml2.Tensor): list of Jacobians w.r.t. unknowns
    B (list of neml2.Tensor): list of Jacobians w.r.t. given variables
    b (list of neml2.Tensor): list of (negative) residuals

Returns:
    tuple of neml2.Tensor: residual, Jacobian w.r.t. unknowns, Jacobian w.r.t. old state
</pre> 
</div>
</div>
<a id="ad507527a95abeb558dbbf8f861dc6341" name="ad507527a95abeb558dbbf8f861dc6341"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad507527a95abeb558dbbf8f861dc6341">&#9670;&#160;</a></span>_assemble() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> tuple[<a class="el" href="classneml2_1_1tensors_1_1Tensor.html">neml2.tensors.Tensor</a>, <a class="el" href="classneml2_1_1tensors_1_1Tensor.html">neml2.tensors.Tensor</a>, <a class="el" href="classneml2_1_1tensors_1_1Tensor.html">neml2.tensors.Tensor</a>] _assemble </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">list[<a class="el" href="classneml2_1_1tensors_1_1Tensor.html">neml2.tensors.Tensor</a>]</td>          <td class="paramname"><span class="paramname"><em>A</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">list[<a class="el" href="classneml2_1_1tensors_1_1Tensor.html">neml2.tensors.Tensor</a>]</td>          <td class="paramname"><span class="paramname"><em>B</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">list[<a class="el" href="classneml2_1_1tensors_1_1Tensor.html">neml2.tensors.Tensor</a>]</td>          <td class="paramname"><span class="paramname"><em>b</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Assemble the residual and Jacobians from A, B, and b

        Args:
            A (list of neml2.Tensor): list of Jacobians w.r.t. unknowns
            B (list of neml2.Tensor): list of Jacobians w.r.t. given variables
            b (list of neml2.Tensor): list of (negative) residuals

        Returns:
            tuple of neml2.Tensor: residual, Jacobian w.r.t. unknowns, Jacobian w.r.t. old state
</pre> 
</div>
</div>
<a id="a07770d00e721194d0a9b1bbcd8e63906" name="a07770d00e721194d0a9b1bbcd8e63906"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07770d00e721194d0a9b1bbcd8e63906">&#9670;&#160;</a></span>_check_model() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">_check_model </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Simple consistency checks, could be a debug check but we only call this once</pre> 
</div>
</div>
<a id="a07770d00e721194d0a9b1bbcd8e63906" name="a07770d00e721194d0a9b1bbcd8e63906"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07770d00e721194d0a9b1bbcd8e63906">&#9670;&#160;</a></span>_check_model() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">_check_model </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Simple consistency checks, could be a debug check but we only call this once
</pre> 
</div>
</div>
<a id="a38aad0821f0055638e4f01ca7d96af0d" name="a38aad0821f0055638e4f01ca7d96af0d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38aad0821f0055638e4f01ca7d96af0d">&#9670;&#160;</a></span>_setup_maps() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">_setup_maps </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Setup the maps for assembly purposes

In the C++ backend, the nonlinear system distinguishes between unknowns (u) and given variables (g).
However, pyzag expects contiguous-in-time representation of the state and forces, where unknowns and old
unknowns come from the state tensor, and forces and old forces come from the forces tensor.

Note that the given variables include old unknowns, forces, and old forces. So we need to setup maps from
the pyzag representation to the nonlinear system representation for both unknowns and given variables.
</pre> 
</div>
</div>
<a id="a38aad0821f0055638e4f01ca7d96af0d" name="a38aad0821f0055638e4f01ca7d96af0d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38aad0821f0055638e4f01ca7d96af0d">&#9670;&#160;</a></span>_setup_maps() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">_setup_maps </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">        Setup the maps for assembly purposes

        In the C++ backend, the nonlinear system distinguishes between unknowns (u) and given variables (g).
        However, pyzag expects contiguous-in-time representation of the state and forces, where unknowns and old
        unknowns come from the state tensor, and forces and old forces come from the forces tensor.

        Note that the given variables include old unknowns, forces, and old forces. So we need to setup maps from
        the pyzag representation to the nonlinear system representation for both unknowns and given variables.
</pre> 
</div>
</div>
<a id="ac701836d3a81103438e81a229f0c1aa0" name="ac701836d3a81103438e81a229f0c1aa0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac701836d3a81103438e81a229f0c1aa0">&#9670;&#160;</a></span>_setup_parameters() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">_setup_parameters </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">list[str]</td>          <td class="paramname"><span class="paramname"><em>exclude_parameters</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Mirror parameters of the NEML2 model with torch.nn.Parameter

Args:
    exclude_parameters (list of str): NEML2 parameters to exclude
</pre> 
</div>
</div>
<a id="ac701836d3a81103438e81a229f0c1aa0" name="ac701836d3a81103438e81a229f0c1aa0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac701836d3a81103438e81a229f0c1aa0">&#9670;&#160;</a></span>_setup_parameters() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">_setup_parameters </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">list[str]</td>          <td class="paramname"><span class="paramname"><em>exclude_parameters</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Mirror parameters of the NEML2 model with torch.nn.Parameter

        Args:
            exclude_parameters (list of str): NEML2 parameters to exclude
</pre> 
</div>
</div>
<a id="a85afbc987b0b493d40b50c58e474ee5c" name="a85afbc987b0b493d40b50c58e474ee5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85afbc987b0b493d40b50c58e474ee5c">&#9670;&#160;</a></span>_update_parameter_values() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">_update_parameter_values </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Copy over new parameter values</pre> 
</div>
</div>
<a id="a85afbc987b0b493d40b50c58e474ee5c" name="a85afbc987b0b493d40b50c58e474ee5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85afbc987b0b493d40b50c58e474ee5c">&#9670;&#160;</a></span>_update_parameter_values() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">_update_parameter_values </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Copy over new parameter values
</pre> 
</div>
</div>
<a id="af9ea75c9b8a6ef11690a4cadc829ef0f" name="af9ea75c9b8a6ef11690a4cadc829ef0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9ea75c9b8a6ef11690a4cadc829ef0f">&#9670;&#160;</a></span>_update_sys() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">_update_sys </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">torch.Tensor</td>          <td class="paramname"><span class="paramname"><em>state</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">torch.Tensor</td>          <td class="paramname"><span class="paramname"><em>forces</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Disassemble the model input forces, old forces, and old state from
the flat tensors and update them in the nonlinear system

Args:
    state (torch.Tensor): tensor containing the model state
    forces (torch.Tensor): tensor containing the model forces
</pre> 
</div>
</div>
<a id="af9ea75c9b8a6ef11690a4cadc829ef0f" name="af9ea75c9b8a6ef11690a4cadc829ef0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9ea75c9b8a6ef11690a4cadc829ef0f">&#9670;&#160;</a></span>_update_sys() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">_update_sys </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">torch.Tensor</td>          <td class="paramname"><span class="paramname"><em>state</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">torch.Tensor</td>          <td class="paramname"><span class="paramname"><em>forces</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">        Disassemble the model input forces, old forces, and old state from
        the flat tensors and update them in the nonlinear system

        Args:
            state (torch.Tensor): tensor containing the model state
            forces (torch.Tensor): tensor containing the model forces
</pre> 
</div>
</div>
<a id="a26cfc528c420175571c1a7645a186455" name="a26cfc528c420175571c1a7645a186455"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26cfc528c420175571c1a7645a186455">&#9670;&#160;</a></span>forward() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> tuple[torch.Tensor, torch.Tensor] forward </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">torch.Tensor</td>          <td class="paramname"><span class="paramname"><em>state</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">torch.Tensor
    </td>          <td class="paramname"><span class="paramname"><em>forces</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Actually call the NEML2 model and return the residual and Jacobian

Args:
    state (torch.Tensor): tensor with the flattened state
    forces (torch.Tensor): tensor with the flattened forces
</pre> 
</div>
</div>
<a id="a26cfc528c420175571c1a7645a186455" name="a26cfc528c420175571c1a7645a186455"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26cfc528c420175571c1a7645a186455">&#9670;&#160;</a></span>forward() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> tuple[torch.Tensor, torch.Tensor] forward </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">torch.Tensor</td>          <td class="paramname"><span class="paramname"><em>state</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">torch.Tensor</td>          <td class="paramname"><span class="paramname"><em>forces</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Actually call the NEML2 model and return the residual and Jacobian

        Args:
            state (torch.Tensor): tensor with the flattened state
            forces (torch.Tensor): tensor with the flattened forces
</pre> 
</div>
</div>
<a id="a191e25e8a248b6d7817a9313e9fdafb2" name="a191e25e8a248b6d7817a9313e9fdafb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a191e25e8a248b6d7817a9313e9fdafb2">&#9670;&#160;</a></span>lookback() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> int lookback </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a610e370ac6b08eb423ab1aab56e8bd65" name="a610e370ac6b08eb423ab1aab56e8bd65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a610e370ac6b08eb423ab1aab56e8bd65">&#9670;&#160;</a></span>lookback() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">lookback </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>lookback</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="acf51b0af154fd972311057c0bf6fd55c" name="acf51b0af154fd972311057c0bf6fd55c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf51b0af154fd972311057c0bf6fd55c">&#9670;&#160;</a></span>nforce() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> int nforce </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="acf51b0af154fd972311057c0bf6fd55c" name="acf51b0af154fd972311057c0bf6fd55c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf51b0af154fd972311057c0bf6fd55c">&#9670;&#160;</a></span>nforce() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> int nforce </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a275dffc664c6501d1091f5bd0fcc6f68" name="a275dffc664c6501d1091f5bd0fcc6f68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a275dffc664c6501d1091f5bd0fcc6f68">&#9670;&#160;</a></span>nstate() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> int nstate </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a275dffc664c6501d1091f5bd0fcc6f68" name="a275dffc664c6501d1091f5bd0fcc6f68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a275dffc664c6501d1091f5bd0fcc6f68">&#9670;&#160;</a></span>nstate() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> int nstate </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a name="doc-variable-members" id="doc-variable-members"></a><h2 id="header-doc-variable-members" class="groupheader">Member Data Documentation</h2>
<a id="a345fb5072bc851057c84323ea1ed7e4c" name="a345fb5072bc851057c84323ea1ed7e4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a345fb5072bc851057c84323ea1ed7e4c">&#9670;&#160;</a></span>_f_to_g_map</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">_f_to_g_map = _index_map_from_to(self.fmap, self.sys.gmap())</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a7b272224a5b701f784df8aa71539eb22" name="a7b272224a5b701f784df8aa71539eb22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b272224a5b701f784df8aa71539eb22">&#9670;&#160;</a></span>_fn_to_g_map</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">_fn_to_g_map = _index_map_from_to(fn_map, self.sys.gmap())</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aa0f5abfaf45aadb3c1d38cc0d0b3d346" name="aa0f5abfaf45aadb3c1d38cc0d0b3d346"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0f5abfaf45aadb3c1d38cc0d0b3d346">&#9670;&#160;</a></span>_g_to_sn_map</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">_g_to_sn_map = _index_map_from_to(self.sys.gmap(), snmap)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aae0fa6572d0acf3ebd0e268473e6c70a" name="aae0fa6572d0acf3ebd0e268473e6c70a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae0fa6572d0acf3ebd0e268473e6c70a">&#9670;&#160;</a></span>_lookback</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int _lookback = 1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad99276e7009b9d9737ee44f41e7673f3" name="ad99276e7009b9d9737ee44f41e7673f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad99276e7009b9d9737ee44f41e7673f3">&#9670;&#160;</a></span>_sn_to_g_map</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">_sn_to_g_map = _index_map_from_to(snmap, self.sys.gmap())</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a9c6cc285517f5bcc703d4f4af36546f0" name="a9c6cc285517f5bcc703d4f4af36546f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c6cc285517f5bcc703d4f4af36546f0">&#9670;&#160;</a></span>flayout</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">list flayout</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=  [</div>
<div class="line">            self.sys.glayout()[i]</div>
<div class="line">            <span class="keywordflow">for</span> i, v <span class="keywordflow">in</span> enumerate(self.sys.gmap())</div>
<div class="line">            <span class="keywordflow">if</span> VariableName(v).start_with(FORCES)</div>
<div class="line">        ]</div>
</div><!-- fragment -->
</div>
</div>
<a id="a012dc2013a9a54ad790e5e4f0ab2dad6" name="a012dc2013a9a54ad790e5e4f0ab2dad6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a012dc2013a9a54ad790e5e4f0ab2dad6">&#9670;&#160;</a></span>fmap</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">list fmap = [v for v in self.sys.gmap() if <a class="el" href="classneml2_1_1core_1_1VariableName.html">VariableName</a>(v).start_with(<a class="el" href="#a2f65bbcb2d2c7ef58453f69b889706dd">FORCES</a>)]</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2f65bbcb2d2c7ef58453f69b889706dd" name="a2f65bbcb2d2c7ef58453f69b889706dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f65bbcb2d2c7ef58453f69b889706dd">&#9670;&#160;</a></span>FORCES</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">str FORCES = 'forces'</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a508cc3106d2c29fe07dc87cbe3ea6927" name="a508cc3106d2c29fe07dc87cbe3ea6927"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a508cc3106d2c29fe07dc87cbe3ea6927">&#9670;&#160;</a></span>model</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">model = sys.model()</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac5ff485b7df21729aed01a8ade6fdc3b" name="ac5ff485b7df21729aed01a8ade6fdc3b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5ff485b7df21729aed01a8ade6fdc3b">&#9670;&#160;</a></span>OLD_FORCES</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">str OLD_FORCES = 'old_forces'</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aedb2960eea276af13468d00e0d71cab7" name="aedb2960eea276af13468d00e0d71cab7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aedb2960eea276af13468d00e0d71cab7">&#9670;&#160;</a></span>OLD_STATE</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">str OLD_STATE = 'old_state'</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aa40e846bf593e5f142f4b9884f6bcc6f" name="aa40e846bf593e5f142f4b9884f6bcc6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa40e846bf593e5f142f4b9884f6bcc6f">&#9670;&#160;</a></span>parameter_names</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">list parameter_names = []</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="afa5ad3a8e19d4be39c0865720f1966ad" name="afa5ad3a8e19d4be39c0865720f1966ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa5ad3a8e19d4be39c0865720f1966ad">&#9670;&#160;</a></span>PARAMETERS</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">str PARAMETERS = 'parameters'</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad855e5fdf082549e6f9f35ace3ac0ef2" name="ad855e5fdf082549e6f9f35ace3ac0ef2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad855e5fdf082549e6f9f35ace3ac0ef2">&#9670;&#160;</a></span>RESIDUAL</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">str RESIDUAL = 'residual'</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="adcd7e38c22c7f3024050998a73b074e8" name="adcd7e38c22c7f3024050998a73b074e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adcd7e38c22c7f3024050998a73b074e8">&#9670;&#160;</a></span>slayout</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">slayout = self.sys.ulayout()</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a7fd6b03fd5d092bdee10e3297251e52b" name="a7fd6b03fd5d092bdee10e3297251e52b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7fd6b03fd5d092bdee10e3297251e52b">&#9670;&#160;</a></span>smap</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">smap = self.sys.umap()</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad05796529f5499cab65861daaa03a7da" name="ad05796529f5499cab65861daaa03a7da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad05796529f5499cab65861daaa03a7da">&#9670;&#160;</a></span>STATE</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">str STATE = 'state'</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a392478988b4565d8886e7b99d2ab3411" name="a392478988b4565d8886e7b99d2ab3411"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a392478988b4565d8886e7b99d2ab3411">&#9670;&#160;</a></span>subaxis_names</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">list subaxis_names = ['state', 'old_state', 'forces', 'old_forces', 'residual', 'parameters']</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a3186d68ed459909f4d5ce3af8547eb75" name="a3186d68ed459909f4d5ce3af8547eb75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3186d68ed459909f4d5ce3af8547eb75">&#9670;&#160;</a></span>sys</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sys = sys</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="namespaceneml2.html">neml2</a></li><li class="navelem"><a href="namespaceneml2_1_1pyzag.html">pyzag</a></li><li class="navelem"><a href="namespaceneml2_1_1pyzag_1_1interface.html">interface</a></li><li class="navelem"><a href="classneml2_1_1pyzag_1_1interface_1_1NEML2PyzagModel.html">NEML2PyzagModel</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.16.1 </li>
  </ul>
</div>
</body>
</html>
